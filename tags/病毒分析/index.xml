<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ç—…æ¯’åˆ†æ :: Tag :: Hacker Site</title><link>http://hacker0x0ff.red/tags/%E7%97%85%E6%AF%92%E5%88%86%E6%9E%90/index.html</link><description/><generator>Hugo</generator><language>en-us</language><lastBuildDate>Sat, 15 Mar 2025 15:30:00 +0800</lastBuildDate><atom:link href="http://hacker0x0ff.red/tags/%E7%97%85%E6%AF%92%E5%88%86%E6%9E%90/index.xml" rel="self" type="application/rss+xml"/><item><title>1.å°†ç¡¬ç›˜ä¸Šçš„PEæ–‡ä»¶å†™å…¥å†…å­˜</title><link>http://hacker0x0ff.red/pe-loader/%E5%86%99%E5%85%A5pe%E8%87%B3%E5%86%85%E5%AD%98/index.html</link><pubDate>Sun, 15 Dec 2024 15:30:00 +0800</pubDate><guid>http://hacker0x0ff.red/pe-loader/%E5%86%99%E5%85%A5pe%E8%87%B3%E5%86%85%E5%AD%98/index.html</guid><description>ä»ç¡¬ç›˜æ˜ å°„PEåˆ°å†…å­˜ ä»ç¡¬ç›˜ç›´æ¥è¯»å–çš„PEæ–‡ä»¶å¤´åä¸º**RawDataã€‚
PointerToRawDataÂ å­—æ®µè®°å½•çš„æ˜¯è¯¥èŠ‚åœ¨ PE æ–‡ä»¶ä¸­çš„èµ·å§‹åç§»é‡ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡è¿™ä¸ªåç§»é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç£ç›˜ä¸Šçš„ PE æ–‡ä»¶ä¸­å‡†ç¡®æ‰¾åˆ°è¯¥èŠ‚çš„åŸå§‹æ•°æ®ã€‚
æ‰€ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç å¯ä»¥å°†ç¡¬ç›˜ä¸­çš„peæ–‡ä»¶æ”¾åˆ°å†…å­˜ä¸­çš„peç»“æ„ä¸­ï¼Œæ¨¡æ‹Ÿäº†windowsä»ç¡¬ç›˜åŠ è½½PEæ–‡ä»¶çš„è¿‡ç¨‹ï¼š
// ç»™PEæ–‡ä»¶åˆ†é…å†…å­˜ if ((pPeBaseAddress = VirtualAlloc(NULL, pPeHdrs->pImgNtHdrs->OptionalHeader.SizeOfImage, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE)) == NULL) { PRINT_WINAPI_ERR("VirtualAlloc"); return FALSE; } // Copying PE headers - IOC // memcpy(pPeBaseAddress, pPeHdrs->pFileBuffer, pPeHdrs->pImgNtHdrs->OptionalHeader.SizeOfHeaders); for (int i = 0; i &lt; pPeHdrs->pImgNtHdrs->FileHeader.NumberOfSections; i++) { memcpy( (PVOID)(pPeBaseAddress + pPeHdrs->pImgSecHdr[i].VirtualAddress),//ç›®çš„åœ°å€ï¼šå†…å­˜åœ°å€+RVA (PVOID)((ULONG_PTR)pPeHdrs->pFileBuffer + pPeHdrs->pImgSecHdr[i].PointerToRawData),//æºåœ°å€ï¼šç¡¬ç›˜åœ°å€+RVA pPeHdrs->pImgSecHdr[i].SizeOfRawData ); }</description></item><item><title>é‡å®šä½çš„å¤„ç†</title><link>http://hacker0x0ff.red/pe-loader/%E9%87%8D%E5%AE%9A%E4%BD%8D%E8%A1%A8%E7%9A%84%E5%A4%84%E7%90%86/index.html</link><pubDate>Sun, 15 Dec 2024 15:30:00 +0800</pubDate><guid>http://hacker0x0ff.red/pe-loader/%E9%87%8D%E5%AE%9A%E4%BD%8D%E8%A1%A8%E7%9A%84%E5%A4%84%E7%90%86/index.html</guid><description>2.é‡å®šä½PEæ–‡ä»¶çš„é‡å®šä½å—å’Œé‡å®šä½é¡¹ å½“å¯æ‰§è¡Œæ˜ åƒåŠ è½½åˆ°çš„åœ°å€ä¸å…¶é¦–é€‰åŸºåœ°å€ï¼ˆIMAGE_OPTIONAL_HEADER.ImageBaseï¼‰ä¸åŒæ—¶ï¼Œé‡å®šä½å¯¹äºè°ƒæ•´å¯æ‰§è¡Œæ˜ åƒä¸­çš„ç¡¬ç¼–ç åœ°å€æ˜¯å¿…è¦çš„ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒPE æ–‡ä»¶ä¼šè¢«æ˜ å°„åˆ°é™¤Â IMAGE_OPTIONAL_HEADER.ImageBaseÂ ä¹‹å¤–çš„åœ°å€ï¼Œå› æ­¤éœ€è¦å¯¹ PE æ–‡ä»¶ä¸­çš„æŸäº›ç¡¬ç¼–ç åœ°å€è¿›è¡Œè°ƒæ•´ã€‚ é€šè¿‡è®¡ç®—å¾—å‡ºåœ°å€å·®å€¼ï¼š
// The difference between the current PE image base address and its preferable base address. ULONG_PTR uDeltaOffset = pPeBaseAddress - pPreferableAddress; ä¸‹é¢æ˜¯å¾®è½¯SDKå®šä¹‰çš„é‡å®šä½å—çš„å¤´éƒ¨ç»“æ„
typedef struct _IMAGE_BASE_RELOCATION { DWORD VirtualAddress; DWORD SizeOfBlock; } IMAGE_BASE_RELOCATION; å¹¶æ²¡æœ‰å¯¹BASE_RELOCATION_ENTRYåšå‡ºå®šä¹‰ï¼Œä½†æè¿°ä¸ºï¼š
æ¯ä¸ªé‡å®šä½æ¡ç›®å ç”¨2å­—èŠ‚(WORD)
æ¯ä¸ªé‡å®šä½æ¡ç›®å ç”¨2å­—èŠ‚(WORD) é«˜4ä½æ˜¯ç±»å‹(Type) ä½12ä½æ˜¯åç§»é‡(Offset) ä»£ç å…·ä½“å®ç°å¯ä»¥æ˜¯ï¼š
typedef struct _BASE_RELOCATION_ENTRY { WORD	Offset	: 12; //å‰12å­—èŠ‚ WORD	Type	: 4; //å4å­—èŠ‚ //WORDæ€»å…±å 16ä½ } BASE_RELOCATION_ENTRY, * PBASE_RELOCATION_ENTRY; IMAGE_BASE_RELOCATIONå’ŒBASE_RELOCATION_ENTRYåœ¨PEæ–‡ä»¶ä¸­çš„ä½ç½®å…³ç³»æ˜¯ï¼š
+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+â€”â€”â€”â€”â€”â€”+â€”â€”â€”â€”â€”â€”+â€” | IMAGE_BASE_RELOCATION (8å­—èŠ‚) | é‡å®šä½æ¡ç›®1 | é‡å®šä½æ¡ç›®2 | â€¦ | - VirtualAddress (4å­—èŠ‚) | (2å­—èŠ‚) | (2å­—èŠ‚) | | - SizeOfBlock (4å­—èŠ‚) | | | +â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-+â€”â€”â€”â€”â€”-+â€”â€”â€”â€“+â€” â†‘ â†‘ pImgBaseRelocation pImgBaseRelocation + 1</description></item><item><title>å¯¼å…¥è¡¨ä¿®å¤</title><link>http://hacker0x0ff.red/pe-loader/iat%E4%BF%AE%E5%A4%8D/index.html</link><pubDate>Sun, 15 Dec 2024 15:30:00 +0800</pubDate><guid>http://hacker0x0ff.red/pe-loader/iat%E4%BF%AE%E5%A4%8D/index.html</guid><description>IATä¿®å¤ IATä¿®å¤æœ‰åŒå±‚å¾ªç¯ï¼Œç¬¬ä¸€å±‚å¾ªç¯æ˜¯åˆ¤æ–­è¿˜æœ‰æ²¡æœ‰dllæ–‡ä»¶ï¼Œç¬¬äºŒå±‚å¾ªç¯æ˜¯åˆ¤æ–­dllå†…çš„å‡½æ•°åˆ°æ²¡åˆ°å¤´ã€‚
å¯¼å…¥è¡¨çš„è®¿é—®ä»IMAGE_DATA_DIRECTORYç»“æ„å¼€å§‹
pehdr.peNtHdr->OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT]
åœ¨peçš„åŸºåœ°å€åŠ ä¸Šè¿™ä¸ªIMAGE_DATA_DIRECTORYçš„VAï¼Œè®¿é—®åˆ°ç¬¬ä¸€ä¸ªPIMAGE_IMPORT_DESCRIPTORç»“æ„
IMAGE_IMPORT_DESCRIPTORÂ ç»“æ„ä½“å¸ƒå±€
| åç§» | å­—æ®µåç§° | ç±»å‹ |Â å¤§å°(å­—èŠ‚) | è¯´æ˜ |
|â€”â€”|â€”â€”â€”-|â€”â€”|â€”â€”â€”â€”|â€”â€”|
|Â 0x00 | OriginalFirstThunk | DWORD | 4 | æŒ‡å‘ INT (å¯¼å…¥åç§°è¡¨) çš„ RVAÂ |
| 0x04 | TimeDateStampÂ | DWORD | 4 | æ—¶é—´æˆ³ï¼Œ0è¡¨ç¤ºæœªç»‘å®šÂ |
| 0x08 | ForwarderChain | DWORD | 4 |Â è½¬å‘é“¾ä¿¡æ¯ |
| 0x0C | Name | DWORD |Â 4 | æŒ‡å‘ DLL åç§°å­—ç¬¦ä¸²çš„ RVA |</description></item><item><title>èŠ‚åŒºæƒé™å¤„ç†</title><link>http://hacker0x0ff.red/pe-loader/%E6%9D%83%E9%99%90%E4%BF%AE%E5%A4%8D/index.html</link><pubDate>Sun, 15 Dec 2024 15:30:00 +0800</pubDate><guid>http://hacker0x0ff.red/pe-loader/%E6%9D%83%E9%99%90%E4%BF%AE%E5%A4%8D/index.html</guid><description>Fix Protection PE æ–‡ä»¶ä¸­çš„æ¯ä¸ªèŠ‚åŒºï¼ˆSectionï¼‰åœ¨Â IMAGE_SECTION_HEADERÂ ä¸­é€šè¿‡Â CharacteristicsÂ å­—æ®µå®šä¹‰äº†åˆå§‹å†…å­˜ä¿æŠ¤å±æ€§ã€‚ä¾‹å¦‚ï¼š
IMAGE_SCN_MEM_EXECUTEÂ (å¯æ‰§è¡Œ) IMAGE_SCN_MEM_READÂ (å¯è¯») IMAGE_SCN_MEM_WRITEÂ (å¯å†™) å†…å­˜ä¿æŠ¤å±æ€§è½¬æ¢ å°† PE æ–‡ä»¶èŠ‚åŒºçš„Â CharacteristicsÂ è½¬æ¢ä¸º Windows å†…å­˜ä¿æŠ¤å¸¸é‡ï¼š
PE èŠ‚åŒºå±æ€§ å†…å­˜ä¿æŠ¤å±æ€§ (WinAPI) EXECUTE PAGE_EXECUTE READ PAGE_READONLY READ + EXECUTE PAGE_EXECUTE_READ READ + WRITE PAGE_READWRITE READ + WRITE + EXECUTE PAGE_EXECUTE_READWRITE â€œç”±äºÂ IMAGE_SECTION_HEADER.CharacteristicsÂ æ˜¯ä¸€ä¸ªä½åŸŸï¼ˆbitfieldï¼‰ï¼Œå®ƒå¯èƒ½åŒæ—¶åŒ…å«å¤šä¸ªæ ‡å¿—ï¼ˆflagsï¼‰ã€‚ä¾‹å¦‚ï¼Œæ£€æŸ¥Â IMAGE_SCN_MEM_READÂ æ ‡å¿—æ—¶ï¼Œå¿…é¡»ä½¿ç”¨æŒ‰ä½ä¸è¿ç®—ç¬¦ï¼ˆ&amp;ï¼‰ï¼Œè€Œä¸æ˜¯ç›¸ç­‰æ€§æ¯”è¾ƒï¼ˆ==ï¼‰ã€‚â€
ä»£ç æ³¨é‡Šï¼š
BOOL FixMemPermissions(IN ULONG_PTR pPeBaseAddress, IN PIMAGE_NT_HEADERS pImgNtHdrs, IN PIMAGE_SECTION_HEADER pImgSecHdr) { //å…¶ä¸­pPeBaseAddressï¼šæ˜¯ä½¿ç”¨virtualAllocåˆ†é…çš„PEåŸºåœ°å€ //IN PIMAGE_NT_HEADERS pImgNtHdrsï¼šæ˜¯Headers.NTheaders //IN PIMAGE_SECTION_HEADER pImgSecHdr:æ˜¯IMAGE_SECTION_HEADERé‡Œé¢çš„Characteristics for (DWORD i = 0; i &lt; pImgNtHdrs->FileHeader.</description></item><item><title>hacker 0x0ff</title><link>http://hacker0x0ff.red/index.html</link><pubDate>Sat, 15 Mar 2025 15:30:00 +0800</pubDate><guid>http://hacker0x0ff.red/index.html</guid><description>æ¬¢è¿æˆ‘çš„æœ‹å‹ ğŸ‘‹ ä½ å¥½ï¼æˆ‘æ˜¯ Harryï¼Œä¸€åä¸“æ³¨äºWindowsç³»ç»Ÿæ¶æ„è½¯ä»¶åˆ†æçš„å®‰å…¨ç ”ç©¶å‘˜ã€‚
æˆ‘çš„ç ”ç©¶é¢†åŸŸ ğŸ” æ¶æ„è½¯ä»¶é€†å‘å·¥ç¨‹ä¸åˆ†æ ğŸ›¡ï¸ Windowsç³»ç»Ÿæ¼æ´ç ”ç©¶ ï¿½ ç—…æ¯’è¡Œä¸ºç‰¹å¾æå– ğŸš« åç—…æ¯’è§„é¿æŠ€æœ¯ç ”ç©¶ ğŸ“Š å¨èƒæƒ…æŠ¥åˆ†æ å¸¸ç”¨æŠ€æœ¯æ ˆ å·¥å…·é›†ï¼š - IDA Pro - OllyDbg - WinDbg - Wireshark - VirtualBoxæ²™ç®±ç¯å¢ƒ ç¼–ç¨‹è¯­è¨€ï¼š - Cï¼ˆæ ·æœ¬å¤ç°ï¼‰ - Pythonï¼ˆè‡ªåŠ¨åŒ–åˆ†æï¼‰ - PowerShellï¼ˆç³»ç»Ÿæ£€æµ‹ï¼‰ - Assemblyï¼ˆé€†å‘å·¥ç¨‹ï¼‰ æœ€æ–°ç ”ç©¶é‡ç‚¹ ç›®å‰æ­£åœ¨æ·±å…¥åˆ†æä»¥ä¸‹æ–¹å‘çš„æ¶æ„è½¯ä»¶æ ·æœ¬ï¼š
åå°„å¼dllæ³¨å…¥(202502è‡³ä»Š) PEæ–‡ä»¶åŠ è½½å™¨(2024-12è‡³2025-02)</description></item><item><title>pe loader</title><link>http://hacker0x0ff.red/pe-loader/index.html</link><pubDate>Sun, 15 Dec 2024 15:30:00 +0800</pubDate><guid>http://hacker0x0ff.red/pe-loader/index.html</guid><description>Local PE Injection æŠŠPE(å¯æ‰§è¡Œ)æ–‡ä»¶æ˜ å°„åˆ°å†…å­˜å¹¶ä½¿ä¹‹æˆåŠŸæ‰§è¡Œï¼Œå’Œshellcodeä¸ä¸€æ ·ï¼Œshellcodeæ³¨å…¥ç®€å•ï¼ŒPEæ˜ å°„å›°éš¾(.exe .dll)
IATä¿®å¤
å†™å…¥PEè‡³å†…å­˜
æƒé™ä¿®å¤
ç¼–è¯‘å™¨é€‰æ‹©
é‡å®šä½è¡¨çš„å¤„ç†</description></item><item><title>reflective DLL injection</title><link>http://hacker0x0ff.red/reflectivedllinjection/index.html</link><pubDate>Sun, 15 Dec 2024 15:30:00 +0800</pubDate><guid>http://hacker0x0ff.red/reflectivedllinjection/index.html</guid><description>å‡½æ•°æ€»è§ˆ
å¯¼å‡ºè¡¨è·å–
æ³¨æ„äº‹é¡¹
windbgè°ƒè¯•</description></item><item><title>windbgè°ƒè¯•dll</title><link>http://hacker0x0ff.red/reflectivedllinjection/windbg_dll/index.html</link><pubDate>Sun, 15 Dec 2024 15:30:00 +0800</pubDate><guid>http://hacker0x0ff.red/reflectivedllinjection/windbg_dll/index.html</guid><description>é€šè¿‡windbgè°ƒè¯•dll:
é¦–å…ˆè¦ç”¨releseæ¨¡å¼ç¼–è¯‘dllæ–‡ä»¶ï¼Œè¿™æ ·pdbè°ƒè¯•æ–‡ä»¶çš„æ ¡éªŒå’Œæ‰ä¼šæ³¨å†Œ
æ¥ä¸‹æ¥è¦åœ¨æ³¨å…¥å™¨æŠŠdllæ³¨å…¥åˆ°å®¿ä¸»è¿›ç¨‹ä¹‹å‰ï¼Œwindbgé™„åŠ åˆ°å®¿ä¸»è¿›ç¨‹
é™„åŠ åˆ°å®¿ä¸»è¿›ç¨‹åä¼šè‡ªåŠ¨è§¦å‘æ–­ç‚¹ï¼š
ç¡®ä¿dllç›®å½•ä¸­æœ‰ä¸ä¹‹åŒ¹é…çš„pdbæ–‡ä»¶
æ¥ä¸‹æ¥è¾“å…¥éœ€è¦åŠ è½½çš„ç¬¦å·æ–‡ä»¶(.pdb)
.sympath+ C:\Project\Debug # æ·»åŠ DLLçš„PDBè·¯å¾„ï¼ˆéœ€ç¼–è¯‘æ—¶ç”Ÿæˆï¼‰ .reload /f mydll.dll #é‡æ–°åŠ è½½è¦æŸ¥çœ‹çš„dllçš„ç¬¦å·æ–‡ä»¶ é‡è¦ï¼
åœ¨æ³¨å…¥ä¹‹å‰æ‰“ä¸Šåœ¨dllmainä¸Šæ–­ç‚¹
bp myDll!DLLmain æ¥ä¸‹æ¥è¿è¡Œç¨‹åºï¼Œ
g ç„¶åæ‰§è¡Œæ³¨å…¥ç¨‹åº
å¦‚æœpdbæ–‡ä»¶æ­£ç¡®å¯¼å…¥ï¼Œé‚£ä¹ˆåœ¨æ³¨å…¥æˆåŠŸçš„ä¸€ç¬é—´ï¼Œä¼šè§¦å‘windbgçš„æ–­ç‚¹
è°ƒè¯•peç»“æ„ï¼š
# å‡è®¾DLLåŸºåœ°å€ä¸º0x180000000ï¼š !dh 0x180000000 # æ‰“å°PEå¤´ï¼ˆæŸ¥æ‰¾å¯é€‰å¤´ï¼‰ dt ntdll!_IMAGE_OPTIONAL_HEADER # æŸ¥çœ‹å¯é€‰å¤´ç»“æ„å®šä¹‰ ? 0x180000000 + &lt;ImportTable RVA> # è®¡ç®—å¯¼å…¥è¡¨å®é™…åœ°å€ åŸºåœ°å€åœ¨processHacker2å†…å¯ä»¥æ‰¾åˆ°
!dh 0xä½ çš„åŸºåœ°å€ ä¼šæ‰“å°å¤´éƒ¨ä¿¡æ¯
å¦‚æœæƒ³è¦æ‰‹åŠ¨æŸ¥æ‰¾ntå¤´å’Œå¯é€‰å¤´ï¼Œå¯ä»¥ä½¿ç”¨
# è¯»å– e_lfanew çš„å€¼ï¼ˆåŸºå€ + 0x3Cï¼‰ dd 0xä½ çš„åŸºåœ°å€ + 0x3C L1 #3Cæ˜¯e_lfanewçš„å›ºå®šå¤§å° æ‰“å°çš„100æ˜¯ntå¤´çš„åç§»
# åŸºå€ + NT Headersåç§» db 0xä½ çš„åŸºåœ°å€ + 0x100 éªŒè¯å‰4ä¸ªå­—èŠ‚æ˜¯å¦ä¸º 50 45 00 00ï¼ˆntå¤´å›ºå®šï¼‰</description></item><item><title>å‡½æ•°æ€»è§ˆ</title><link>http://hacker0x0ff.red/reflectivedllinjection/%E5%87%BD%E6%95%B0%E6%80%BB%E8%A7%88/index.html</link><pubDate>Sun, 15 Dec 2024 15:30:00 +0800</pubDate><guid>http://hacker0x0ff.red/reflectivedllinjection/%E5%87%BD%E6%95%B0%E6%80%BB%E8%A7%88/index.html</guid><description>DLLEXPORT ULONG_PTR WINAPI ReflectiveLoader() { // 1. å®šä½è‡ªèº« PE å¤´ï¼ˆç•¥ï¼‰ // 2. åˆ†é…å†…å­˜å¹¶å¤åˆ¶ PE å¤´å’ŒèŠ‚åŒºï¼ˆç•¥ï¼‰ // 3. å¤„ç†é‡å®šä½ ProcessRelocations(memBase, delta); // 4. è§£æå¯¼å…¥è¡¨ ResolveImports(memBase); // 5. è®¾ç½®å†…å­˜æƒé™ SetMemoryProtections(memBase); // 6. è°ƒç”¨ DllMain CallDllMain(memBase, DLL_PROCESS_ATTACH); return memBase; }</description></item><item><title>æ›´å¤šå¯¼å…¥è¡¨å†…å®¹</title><link>http://hacker0x0ff.red/pe-loader/iat%E4%BF%AE%E5%A4%8D/%E6%9B%B4%E5%A4%9A/index.html</link><pubDate>Sun, 15 Dec 2024 15:30:00 +0800</pubDate><guid>http://hacker0x0ff.red/pe-loader/iat%E4%BF%AE%E5%A4%8D/%E6%9B%B4%E5%A4%9A/index.html</guid><description>IAT dllåŒ…å« å¯ä»¥é€šè¿‡IMAGE_IMPORT_DESCRIPTORè®¿é—®PEæ–‡ä»¶ä¸­DLLåç§°ï¼ŒINTï¼ŒIATçš„åœ°å€
typedef struct _IMAGE_IMPORT_DESCRIPTOR { union { DWORD Characteristics; // 0 è¡¨ç¤ºç»“æ„æ•°ç»„çš„ç»“æŸ DWORD OriginalFirstThunk; // æŒ‡å‘ INT (Import Name Table) } DUMMYUNIONNAME; DWORD TimeDateStamp; // æ—¶é—´æˆ³ DWORD ForwarderChain; // è½¬å‘é“¾ DWORD Name; // DLLåç§°çš„RVA DWORD FirstThunk; // æŒ‡å‘ IAT (Import Address Table) } IMAGE_IMPORT_DESCRIPTOR; // PEæ–‡ä»¶çš„å¯¼å…¥è¡¨å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š å¯¼å…¥è¡¨ â”œâ”€â”€ Import Descriptor 1 (kernel32.dll) â”‚ â”œâ”€â”€ Name: "kernel32.dll" //DLLçš„åç§° â”‚ â”œâ”€â”€ OriginalFirstThunk: -> [å‡½æ•°1, å‡½æ•°2, ...] //INTçš„RVA â”‚ â””â”€â”€ FirstThunk: -> [åœ°å€1, åœ°å€2, .</description></item><item><title>æ›´é‡è¦çš„...</title><link>http://hacker0x0ff.red/pe-loader/%E7%BC%96%E8%AF%91%E5%99%A8%E9%80%89%E6%8B%A9/index.html</link><pubDate>Sun, 15 Dec 2024 15:30:00 +0800</pubDate><guid>http://hacker0x0ff.red/pe-loader/%E7%BC%96%E8%AF%91%E5%99%A8%E9%80%89%E6%8B%A9/index.html</guid><description>ç¼–è¯‘å™¨é€‰æ‹©</description></item><item><title>æ³¨æ„äº‹é¡¹1</title><link>http://hacker0x0ff.red/reflectivedllinjection/%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/index.html</link><pubDate>Sun, 15 Dec 2024 15:30:00 +0800</pubDate><guid>http://hacker0x0ff.red/reflectivedllinjection/%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/index.html</guid><description>åœ¨ç¼–å†™dlléƒ¨åˆ†æ—¶ï¼Œä¸ºäº†æ–¹ä¾¿æ‰§è¡Œdllï¼Œæˆ‘å†™äº†ä¸€ä¸ªç¨‹åºå¿«é€Ÿæ‰§è¡Œdll
HMODULE dllname = LoadLibraryA("dll.dll"); if (!dllname) { printf("dllname don't exitsts!\n"); return 0; } ReflectiveLoaderFunc myfuc = (ReflectiveLoaderFunc)GetProcAddress(dllname, "ReflectiveLoader"); myfuc(); ç„¶è€Œè¿™æ ·çš„ç¨‹åºåœ¨åå°„å¼dllå¤„ç†é‡å®šä½è¡¨æ—¶ä¼šå‡ºå¤§é—®é¢˜ï¼š â€¢ é€šè¿‡Â LoadLibraryÂ åŠ è½½çš„DLLå·²è¢«ç³»ç»Ÿä¿®æ”¹ï¼ˆé‡å®šä½+å¯¼å…¥è¡¨å¤„ç†ï¼‰ï¼Œ.relocÂ èŠ‚å¯èƒ½è¢«ä¸¢å¼ƒæˆ–æ“¦å†™ã€‚</description></item><item><title>è·å–ç£ç›˜dll(æœªåŠ è½½)çš„å¯¼å‡ºè¡¨</title><link>http://hacker0x0ff.red/reflectivedllinjection/%E5%AF%BC%E5%87%BA%E8%A1%A8%E8%8E%B7%E5%8F%96%E7%A3%81%E7%9B%98/index.html</link><pubDate>Sun, 15 Dec 2024 15:30:00 +0800</pubDate><guid>http://hacker0x0ff.red/reflectivedllinjection/%E5%AF%BC%E5%87%BA%E8%A1%A8%E8%8E%B7%E5%8F%96%E7%A3%81%E7%9B%98/index.html</guid><description>ç£ç›˜ä¸­çš„RVAå’ŒåŠ è½½åçš„RVAè®¿é—®æ–¹å¼æ˜¯ä¸åŒçš„
å¦‚æœå·²ç»æŒ‰å†…å­˜è¦æ±‚åŠ è½½ï¼š
åŸºåœ°å€+DataDirectory[0]
å¦‚æœè¿˜æ˜¯ç¡¬ç›˜æ ¼å¼ï¼š
åç§»é‡ = RVA - åŒºæ®µçš„VirtualAddress + åŒºæ®µçš„PointerToRawData åŸºåœ°å€+åç§»é‡
è¿™é‡Œä¸»è¦ç†è§£å†…å­˜æ ¼å¼å’Œç¡¬ç›˜æ ¼å¼å¯¹RVAçš„å½±å“</description></item></channel></rss>