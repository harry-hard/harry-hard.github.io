<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>1.将硬盘上的PE文件写入内存 :: Hacker Site</title>
    <link>http://localhost:1313/pe-loader/pe-loader/%E5%86%99%E5%85%A5pe%E8%87%B3%E5%86%85%E5%AD%98/index.html</link>
    <description></description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 15 Dec 2024 15:30:00 +0800</lastBuildDate>
    <atom:link href="http://localhost:1313/pe-loader/pe-loader/%E5%86%99%E5%85%A5pe%E8%87%B3%E5%86%85%E5%AD%98/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>写入pe至内存中</title>
      <link>http://localhost:1313/pe-loader/pe-loader/%E5%86%99%E5%85%A5pe%E8%87%B3%E5%86%85%E5%AD%98/1-%E4%BB%8E%E7%A1%AC%E7%9B%98%E6%98%A0%E5%B0%84pe%E5%88%B0%E5%86%85%E5%AD%98/index.html</link>
      <pubDate>Sun, 15 Dec 2024 15:30:00 +0800</pubDate>
      <guid>http://localhost:1313/pe-loader/pe-loader/%E5%86%99%E5%85%A5pe%E8%87%B3%E5%86%85%E5%AD%98/1-%E4%BB%8E%E7%A1%AC%E7%9B%98%E6%98%A0%E5%B0%84pe%E5%88%B0%E5%86%85%E5%AD%98/index.html</guid>
      <description>1.从硬盘映射PE到内存 从硬盘直接读取的PE文件头名为**RawData。**&#xA;PointerToRawData 字段记录的是该节在 PE 文件中的起始偏移量（以字节为单位）。也就是说，通过这个偏移量，我们可以在磁盘上的 PE 文件中准确找到该节的原始数据。&#xA;所以通过以下代码可以将硬盘中的pe文件放到内存中的pe结构中，模拟了windows从硬盘加载PE文件的过程：&#xA;// 给PE文件分配内存 if ((pPeBaseAddress = VirtualAlloc(NULL, pPeHdrs-&gt;pImgNtHdrs-&gt;OptionalHeader.SizeOfImage, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE)) == NULL) { PRINT_WINAPI_ERR(&#34;VirtualAlloc&#34;); return FALSE; } // Copying PE headers - IOC // memcpy(pPeBaseAddress, pPeHdrs-&gt;pFileBuffer, pPeHdrs-&gt;pImgNtHdrs-&gt;OptionalHeader.SizeOfHeaders); for (int i = 0; i &lt; pPeHdrs-&gt;pImgNtHdrs-&gt;FileHeader.NumberOfSections; i++) { memcpy( (PVOID)(pPeBaseAddress + pPeHdrs-&gt;pImgSecHdr[i].VirtualAddress),//目的地址：内存地址+RVA (PVOID)((ULONG_PTR)pPeHdrs-&gt;pFileBuffer + pPeHdrs-&gt;pImgSecHdr[i].PointerToRawData),//源地址：硬盘地址+RVA pPeHdrs-&gt;pImgSecHdr[i].SizeOfRawData ); }</description>
    </item>
  </channel>
</rss>