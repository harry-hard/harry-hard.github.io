<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>通过PEB和PE导出表获取函数 :: Hacker Site</title><link>http://hacker0x0ff.red/reflectivedllinjection/peb%E5%92%8Cpe%E8%8E%B7%E5%8F%96%E5%87%BD%E6%95%B0%E5%9C%B0%E5%9D%80/index.html</link><description>peb结构获取dll地址
PBYTE getDllAddress(wchar_t* dllName) { //通过PEB结构获取dll地址 PPEB pPeb = __readgsqword(0x60); PPEB_LDR_DATA ldr = pPeb->Ldr; PLIST_ENTRY head = &amp;ldr->InMemoryOrderModuleList; PLIST_ENTRY flink = head->Flink; PBYTE kernel32dllAddr = NULL; while (flink != head) { PLDR_DATA_TABLE_ENTRY entry = (ULONG_PTR)flink - LDR_OFFSET; //AI写的 PWSTR filename = wcsrchr(entry->FullDllName.Buffer, L'\\'); filename = filename ? filename + 1 : entry->FullDllName.Buffer; //AI结束 if (_wcsicmp(filename, dllName) == 0) { kernel32dllAddr = entry->DllBase; break; } else flink = flink->Flink; } if (!</description><generator>Hugo</generator><language>en-us</language><lastBuildDate/><atom:link href="http://hacker0x0ff.red/reflectivedllinjection/peb%E5%92%8Cpe%E8%8E%B7%E5%8F%96%E5%87%BD%E6%95%B0%E5%9C%B0%E5%9D%80/index.xml" rel="self" type="application/rss+xml"/></channel></rss>